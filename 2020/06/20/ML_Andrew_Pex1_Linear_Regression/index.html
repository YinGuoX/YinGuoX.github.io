<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="King">
  <meta name="keywords" content="">
  <title>机器学习程序练习1:线性回归 - 因果</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css" />

<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">



  <link  rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css" />




<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


<meta name="generator" content="Hexo 4.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>因果</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">现今</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">旧日</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">关于</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/textbg.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  星期六, 六月 20日 2020, 8:46 晚上
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    2.6k 字
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                    
                    
                    40
                     分钟
                  </span>
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  <span id="busuanzi_container_page_pv" class="post-meta" style="display: none">
                    <i class="far fa-eye" aria-hidden="true"></i>
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <div class="markdown-body">
              <h1 id="吴恩达机器学习程序练习1-线性回归"><a href="#吴恩达机器学习程序练习1-线性回归" class="headerlink" title="吴恩达机器学习程序练习1:线性回归"></a>吴恩达机器学习程序练习1:线性回归</h1><p>更多详细信息可参考同文件夹下的andrew_ml_ex14179</p>
<pre><code class="lang-python"># 导入对应的第三方库
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
</code></pre>
<h2 id="1-简单练习"><a href="#1-简单练习" class="headerlink" title="1.简单练习"></a>1.简单练习</h2><pre><code class="lang-python">A = np.eye(6)
A
</code></pre>
<pre><code>array([[1., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0.],
       [0., 0., 0., 0., 1., 0.],
       [0., 0., 0., 0., 0., 1.]])
</code></pre><h2 id="2-单变量的线性回归"><a href="#2-单变量的线性回归" class="headerlink" title="2.单变量的线性回归"></a>2.单变量的线性回归</h2><p>根据城市人口数量，预测开小吃店的利润。<br>数据在ex1data1.txt中，第一列是城市人口数量，第二列是该城市小吃店利润</p>
<h3 id="2-1-Plotting-the-data"><a href="#2-1-Plotting-the-data" class="headerlink" title="2.1 Plotting the data"></a>2.1 Plotting the data</h3><pre><code class="lang-python"># 读入数据并且显示
path = &#39;./andrew_ml_ex14179/ex1data1.txt&#39;
# header=1：以第一行数据作为列索引(列名)
# names = [...]:给定列名
# 返回DataFrame类型,Population：人口(万)
data = pd.read_csv(path,header=None,names=[&#39;Population&#39;,&#39;Profit&#39;])
# DataFrame.head([N]):返回前N行
data.head(94)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
      <th>Profit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.1101</td>
      <td>17.5920</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.5277</td>
      <td>9.1302</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.5186</td>
      <td>13.6620</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.0032</td>
      <td>11.8540</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.8598</td>
      <td>6.8233</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>89</th>
      <td>5.0594</td>
      <td>2.8214</td>
    </tr>
    <tr>
      <th>90</th>
      <td>5.7077</td>
      <td>1.8451</td>
    </tr>
    <tr>
      <th>91</th>
      <td>7.6366</td>
      <td>4.2959</td>
    </tr>
    <tr>
      <th>92</th>
      <td>5.8707</td>
      <td>7.2029</td>
    </tr>
    <tr>
      <th>93</th>
      <td>5.3054</td>
      <td>1.9869</td>
    </tr>
  </tbody>
</table>
<p>94 rows × 2 columns</p>
</div>




<pre><code class="lang-python"># 将数据绘图成散点图
data.plot(kind=&#39;scatter&#39;,x=&#39;Population&#39;,y=&#39;Profit&#39;,figsize=(12,8))
plt.show()
</code></pre>
<p><img src="/img/ML_Andrew/output_8_0.png" srcset="/img/loading.gif" alt="png"></p>
<h3 id="2-2-梯度下降"><a href="#2-2-梯度下降" class="headerlink" title="2.2 梯度下降"></a>2.2 梯度下降</h3><p>使用传统的线性回归的代价函数</p>
<h4 id="2-2-1-公式"><a href="#2-2-1-公式" class="headerlink" title="2.2.1 公式"></a>2.2.1 公式</h4><p><img src="attachment:1.1.png" srcset="/img/loading.gif" alt="1.1.png"></p>
<pre><code class="lang-python"># X是矩阵
def computeCost(X,y,theta):
    # *对应元素相乘
    inner = np.power(((X*theta.T)-y),2)
    return np.sum(inner)/(2*len(X))
</code></pre>
<pre><code class="lang-python"># 验证矩阵间的乘法(*)是对应元素相乘
x=np.array([[1,2],[3,4]])
y=np.array([[1,2],[3,4]])
print(x*y)
# 这才是真正的矩阵的乘法
print(x.dot(y))
# 对应元素相减
print(x-y)
</code></pre>
<pre><code>[[ 1  4]
 [ 9 16]]
[[ 7 10]
 [15 22]]
[[0 0]
 [0 0]]
</code></pre><h4 id="2-2-2-实现"><a href="#2-2-2-实现" class="headerlink" title="2.2.2 实现"></a>2.2.2 实现</h4><p>新加一列x，用于更新theta,并且将theta初始化为0，学习率初始化为0.01，迭代次数为1500次</p>
<pre><code class="lang-python"># 在第0列新增一列索引为Ones的全部为1的数据
data.insert(0,&#39;Ones&#39;,1)
# 删除某一列 要axis=1，因为默认是行
# 并且要inplace=True,才是对原数据进行操作
data.head(100)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ones</th>
      <th>Population</th>
      <th>Profit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>6.1101</td>
      <td>17.59200</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>5.5277</td>
      <td>9.13020</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>8.5186</td>
      <td>13.66200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>7.0032</td>
      <td>11.85400</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5.8598</td>
      <td>6.82330</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92</th>
      <td>1</td>
      <td>5.8707</td>
      <td>7.20290</td>
    </tr>
    <tr>
      <th>93</th>
      <td>1</td>
      <td>5.3054</td>
      <td>1.98690</td>
    </tr>
    <tr>
      <th>94</th>
      <td>1</td>
      <td>8.2934</td>
      <td>0.14454</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1</td>
      <td>13.3940</td>
      <td>9.05510</td>
    </tr>
    <tr>
      <th>96</th>
      <td>1</td>
      <td>5.4369</td>
      <td>0.61705</td>
    </tr>
  </tbody>
</table>
<p>97 rows × 3 columns</p>
</div>




<pre><code class="lang-python"># 初始化
# 获得data的列数，0为行数
cols=data.shape[1]
print(cols)
# [,]先行后列,获取对应行列对应区域的数据
X = data.iloc[:,:-1]
Y = data.iloc[:,cols-1:cols]
# X训练集 Y目标集
print(type(X))
print(type(Y))
</code></pre>
<pre><code>3
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</code></pre><pre><code class="lang-python"># 因为代价函数使用的是numpy矩阵，所以要转换X和Y，并且初始化theta
# X.values:获取X的值，没有索引了
# print(type(X.values))
# print(Y.values)
print(type(X))
# 将X，Y转换为对应的矩阵
X=np.matrix(X)
# print(X)
print(X)
print(type(Y))
y=np.matrix(Y.values)
print(type(y))
theta = np.asmatrix(np.array([0,0]))
print(theta)
</code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
[[ 1.      6.1101]
 [ 1.      5.5277]
 [ 1.      8.5186]
 [ 1.      7.0032]
 [ 1.      5.8598]
 [ 1.      8.3829]
 [ 1.      7.4764]
 [ 1.      8.5781]
 [ 1.      6.4862]
 [ 1.      5.0546]
 [ 1.      5.7107]
 [ 1.     14.164 ]
 [ 1.      5.734 ]
 [ 1.      8.4084]
 [ 1.      5.6407]
 [ 1.      5.3794]
 [ 1.      6.3654]
 [ 1.      5.1301]
 [ 1.      6.4296]
 [ 1.      7.0708]
 [ 1.      6.1891]
 [ 1.     20.27  ]
 [ 1.      5.4901]
 [ 1.      6.3261]
 [ 1.      5.5649]
 [ 1.     18.945 ]
 [ 1.     12.828 ]
 [ 1.     10.957 ]
 [ 1.     13.176 ]
 [ 1.     22.203 ]
 [ 1.      5.2524]
 [ 1.      6.5894]
 [ 1.      9.2482]
 [ 1.      5.8918]
 [ 1.      8.2111]
 [ 1.      7.9334]
 [ 1.      8.0959]
 [ 1.      5.6063]
 [ 1.     12.836 ]
 [ 1.      6.3534]
 [ 1.      5.4069]
 [ 1.      6.8825]
 [ 1.     11.708 ]
 [ 1.      5.7737]
 [ 1.      7.8247]
 [ 1.      7.0931]
 [ 1.      5.0702]
 [ 1.      5.8014]
 [ 1.     11.7   ]
 [ 1.      5.5416]
 [ 1.      7.5402]
 [ 1.      5.3077]
 [ 1.      7.4239]
 [ 1.      7.6031]
 [ 1.      6.3328]
 [ 1.      6.3589]
 [ 1.      6.2742]
 [ 1.      5.6397]
 [ 1.      9.3102]
 [ 1.      9.4536]
 [ 1.      8.8254]
 [ 1.      5.1793]
 [ 1.     21.279 ]
 [ 1.     14.908 ]
 [ 1.     18.959 ]
 [ 1.      7.2182]
 [ 1.      8.2951]
 [ 1.     10.236 ]
 [ 1.      5.4994]
 [ 1.     20.341 ]
 [ 1.     10.136 ]
 [ 1.      7.3345]
 [ 1.      6.0062]
 [ 1.      7.2259]
 [ 1.      5.0269]
 [ 1.      6.5479]
 [ 1.      7.5386]
 [ 1.      5.0365]
 [ 1.     10.274 ]
 [ 1.      5.1077]
 [ 1.      5.7292]
 [ 1.      5.1884]
 [ 1.      6.3557]
 [ 1.      9.7687]
 [ 1.      6.5159]
 [ 1.      8.5172]
 [ 1.      9.1802]
 [ 1.      6.002 ]
 [ 1.      5.5204]
 [ 1.      5.0594]
 [ 1.      5.7077]
 [ 1.      7.6366]
 [ 1.      5.8707]
 [ 1.      5.3054]
 [ 1.      8.2934]
 [ 1.     13.394 ]
 [ 1.      5.4369]]
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
&lt;class &#39;numpy.matrix&#39;&gt;
[[0 0]]
</code></pre><pre><code class="lang-python"># 查看对应维度
X.shape,theta.shape,y.shape
print(theta.size)
</code></pre>
<pre><code>2
</code></pre><h4 id="2-2-3-计算代价函数"><a href="#2-2-3-计算代价函数" class="headerlink" title="2.2.3 计算代价函数"></a>2.2.3 计算代价函数</h4><p>theta初始为0<br>computeCost(X,y,theta)</p>
<pre><code class="lang-python">computeCost(X,y,theta)
</code></pre>
<pre><code>32.072733877455676
</code></pre><h4 id="2-2-4-梯度下降算法"><a href="#2-2-4-梯度下降算法" class="headerlink" title="2.2.4 梯度下降算法"></a>2.2.4 梯度下降算法</h4><p>目标是最小化代价函数J(theta)，变量是theta不是X和y,通过变换theta来变化代价函数，进而使代价函数最小。<br>检查梯度下降算法是否正确运行，可以打印J(theta)的值来判断是否在不断减小，并且最后收敛到一个稳定的值。</p>
<pre><code class="lang-python">def gradientDescent(X,y,theta,alpha,iters):
    # 初始化参数矩阵
    temp=np.matrix(np.zeros(theta.shape))
    # ravel()将矩阵扁平化
    # 获取参数theta的个数
    parameters = int(theta.ravel().shape[1])
    # 用来存储代价
    cost = np.zeros(iters)
    thetax = np.zeros((iters,theta.size))
    # print(thetax)
    for i in range(iters):
        # 计算代价误差
        # h_theta(x)-y
        error = (X*theta.T)-y
        for j in range(parameters):
            # np.multiply()对应元素相乘
            # 计算J(theta)的导数
            term = np.multiply(error,X[:,j])
            # 进行梯度下降
            temp[0,j]=theta[0,j]-((alpha/len(X)))*np.sum(term)
            thetax[i][j]=temp[0,j]
        theta = temp
        cost[i]=computeCost(X,y,theta)
    return theta,cost,thetax
</code></pre>
<pre><code class="lang-python"># 初始化alpha 和 iters
alpha = 0.01
iters = 1500
# 运行梯度下降算法来找到适合训练集的theta
g,cost,thetax = gradientDescent(X,y,theta,alpha,iters)
g
</code></pre>
<pre><code>matrix([[-3.63029144,  1.16636235]])
</code></pre><pre><code class="lang-python"># 预测35000和70000城市规模的小吃利润
predict1 = [1,3.5]*g.T
print(&quot;predict1:&quot;,predict1)
predict2=[1,7]*g.T
print(&quot;predict2:&quot;,predict2)
</code></pre>
<pre><code>predict1: [[0.45197679]]
predict2: [[4.53424501]]
</code></pre><pre><code class="lang-python"># 显示原始数据以及拟合的线性回归方程
# numpy.linspace(start, stop, num=50, endpoint=True, retstep=False, dtype=None)
# 在[start,stop]返回num均匀分布的样本
x = np.linspace(data.Population.min(),data.Population.max(),100)
# print(x)
f = g[0,0]+(g[0,1]*x)
# plt.subplots(1,3,figsize=(12,8))设置一个1行3个12*8大小的子图
# 返回一个figure图像和一个子图ax的列表
fig ,ax =plt.subplots(figsize=(12,8))
# ax.plot()绘制一条线
ax.plot(x,f,&#39;r&#39;,label=&#39;Prediction&#39;)
# ax.scatter()绘制一个散点图
ax.scatter(data.Population,data.Profit,label=&#39;Training Data&#39;)
# ax.legend(loc=1)显示图中的标签在第一象限
ax.legend(loc=1)
ax.set_xlabel(&quot;Population&quot;)
ax.set_ylabel(&#39;Profit&#39;)
ax.set_title(&quot;Predicted Profit vs. Population Size&quot;)
plt.show()
</code></pre>
<p><img src="/img/ML_Andrew/output_23_0.png" srcset="/img/loading.gif" alt="png"></p>
<h3 id="2-3可视化J-theta-未完待续"><a href="#2-3可视化J-theta-未完待续" class="headerlink" title="2.3可视化J(theta)(未完待续)"></a>2.3可视化J(theta)(未完待续)</h3><p>希望能够画出J(theta)与theta0,theta1之间的对应关系，应该是一个三维图像</p>
<pre><code class="lang-python">print(thetax.shape)
print(cost.shape)
print(X.shape)
print(y.shape)
print(cost)
</code></pre>
<pre><code>(1500, 2)
(1500,)
(97, 2)
(97, 1)
[6.73719046 5.93159357 5.90115471 ... 4.48343473 4.48341145 4.48338826]
</code></pre><pre><code class="lang-python"># 绘制3d图像
# 直接根据theta0,theta1,costfunction对应的点来绘制出的散点图
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import cm
fig=plt.figure()
ax=fig.add_subplot(111,projection=&#39;3d&#39;)
x=thetax[:,0]
y1=thetax[:,1]
ax.plot_trisurf(x,y1,cost,)
plt.show()
</code></pre>
<p><img src="/img/ML_Andrew/output_26_0.png" srcset="/img/loading.gif" alt="png"></p>
<h2 id="3-多变量线性回归"><a href="#3-多变量线性回归" class="headerlink" title="3 多变量线性回归"></a>3 多变量线性回归</h2><p>数据集:ex1data2.txt：<br>第一列：房屋大小<br>第二列：卧室数量<br>第三列：房屋售价<br>根据已有数据建立模型，预测房屋的售价</p>
<pre><code class="lang-python"># 读入数据并且显示
path = &#39;./andrew_ml_ex14179/ex1data2.txt&#39;
# header=1：以第一行数据作为列索引(列名)
# names = [...]:给定列名
# 返回DataFrame类型,Population：人口(万)
data2 = pd.read_csv(path,header=None,names=[&#39;Size&#39;,&#39;Bedrooms&#39;,&#39;Price&#39;])
# DataFrame.head([N]):返回前N行
print(data2.head())
print(data2.shape)
</code></pre>
<pre><code>   Size  Bedrooms   Price
0  2104         3  399900
1  1600         3  329900
2  2400         3  369000
3  1416         2  232000
4  3000         4  539900
(47, 3)
</code></pre><h3 id="3-1-特征缩放-Feature-Scaling"><a href="#3-1-特征缩放-Feature-Scaling" class="headerlink" title="3.1 特征缩放(Feature Scaling)"></a>3.1 特征缩放(Feature Scaling)</h3><p>根据数据得知，size变量的大小是bedrooms的1000倍，所以最好统一量级，可以使梯度下降收敛的更快</p>
<h4 id="3-1-1Mean-Normalization-均值归一化"><a href="#3-1-1Mean-Normalization-均值归一化" class="headerlink" title="3.1.1Mean Normalization(均值归一化)"></a>3.1.1Mean Normalization(均值归一化)</h4><p>特征减去平均值再除以标准差</p>
<pre><code class="lang-python">data2 = (data2-data2.mean())/data2.std()
data2.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Size</th>
      <th>Bedrooms</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.130010</td>
      <td>-0.223675</td>
      <td>0.475747</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.504190</td>
      <td>-0.223675</td>
      <td>-0.084074</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.502476</td>
      <td>-0.223675</td>
      <td>0.228626</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.735723</td>
      <td>-1.537767</td>
      <td>-0.867025</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.257476</td>
      <td>1.090417</td>
      <td>1.595389</td>
    </tr>
  </tbody>
</table>
</div>



<h3 id="3-2-梯度下降算法"><a href="#3-2-梯度下降算法" class="headerlink" title="3.2 梯度下降算法"></a>3.2 梯度下降算法</h3><pre><code class="lang-python"># 为了能够根据矩阵运算，添加一列常数项
# data2.drop(&#39;Ones&#39;,axis=1,inplace=True)
data2.insert(0,&#39;Ones&#39;,1)
# 初始化x,y
cols = data2.shape[1]
X2=data2.iloc[:,0:cols-1]
y2=data2.iloc[:,cols-1:cols]
# 转换为matrix格式并且初始化theta
x2=np.matrix(X2)
y2=np.matrix(y2)
theta2 = np.matrix(np.array([0,0,0]))
# 运行梯度下降算法
print(&quot;开始运行梯度下降算法&quot;)
g2,cost2,thetax=gradientDescent(x2,y2,theta2,alpha,iters)
g2
</code></pre>
<pre><code>开始运行梯度下降算法
matrix([[-1.10898288e-16,  8.84042349e-01, -5.24551809e-02]])
</code></pre><h3 id="3-3-Normal-Equation-正规方程算法"><a href="#3-3-Normal-Equation-正规方程算法" class="headerlink" title="3.3 Normal Equation(正规方程算法)"></a>3.3 Normal Equation(正规方程算法)</h3><p>正规方程是直接以theta为变量求解J(theta)的最小值，也即是直接求每个theta的偏导并且令其为0，求解方程即可<br>则利用正规方程解出向量：</p>
<script type="math/tex; mode=display">\theta = (X^TX)^{-1}X^Ty</script><p>梯度下降 VS 正规方程<br>梯度下降：需要选择学习率α，需要多次迭代，当特征数量n大时也能较好适用，适用于各种类型的模型<br>正规方程：不需要选择学习率α，一次计算得出，需要计算$(X^TX)^{-1}$，如果特征数量n较大则运算代价大，因为矩阵逆的计算时间复杂度为O($n^3$)，通常来说当小于10000 时还是可以接受的，只适用于线性模型，不适合逻辑回归模型等其他模型</p>
<pre><code class="lang-python"># 正规方程
def normalEqn(X,y):
# numpy.linalg模块包含线性代数的函数。
# 使用这个模块，可以计算逆矩阵、求特征值、解线性方程组以及求解行列式等
# inv()求解矩阵的逆
# pinv()求解矩阵的伪逆
    theta = np.linalg.inv(X.T.dot(X))
    theta = theta.dot(X.T)
    theta = theta.dot(y)
    return theta
</code></pre>
<pre><code class="lang-python"># 使用data1数据进行验证
final_theta2=normalEqn(X,y)
final_theta2
</code></pre>
<pre><code>matrix([[-3.89578088],
        [ 1.19303364]])
</code></pre><pre><code class="lang-python"># 使用梯度下降算法
# 初始化alpha 和 iters
alpha = 0.01
iters = 1500
# 运行梯度下降算法来找到适合训练集的theta
g,cost,thetax = gradientDescent(X,y,theta,alpha,iters)
g
</code></pre>
<pre><code>matrix([[-3.63029144,  1.16636235]])
</code></pre><p>```python</p>

            </div>
            <hr>
            <div>
              <p>
                
                  <span>
                <i class="iconfont icon-inbox"></i>
                    
                      <a class="hover-with-bg" href="/categories/Programming/">Programming</a>
                      &nbsp;
                    
                      <a class="hover-with-bg" href="/categories/Programming/ML/">ML</a>
                      &nbsp;
                    
                      <a class="hover-with-bg" href="/categories/Programming/ML/Programming-Exercise/">Programming Exercise</a>
                      &nbsp;
                    
                  </span>&nbsp;&nbsp;
                
                
                  <span>
                <i class="iconfont icon-tag"></i>
                    
                      <a class="hover-with-bg" href="/tags/Programming/">Programming</a>
                    
                      <a class="hover-with-bg" href="/tags/ML/">ML</a>
                    
                      <a class="hover-with-bg" href="/tags/Programming-Exercise/">Programming Exercise</a>
                    
                      <a class="hover-with-bg" href="/tags/Andrew-Ng/">Andrew Ng</a>
                    
                  </span>
                
              </p>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/05/11/CprogrammingT18/">
                        <span class="hidden-mobile">C语言编程T18</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="fa fa-chevron-right"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

              
                <!-- Comments -->
                <div class="comments" id="comments">
                  
                  
  <script defer src="https://utteranc.es/client.js"
          repo="YinGuoX/commit-utterance"
          issue-term="pathname"
  
          label="utterances"
    
          theme="github-light"
          crossorigin="anonymous"
  >
  </script>


                </div>
              
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">

  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
	  <div>
  <span id="timeDate">载入天数...</span>
  <span id="times">载入时分秒...</span>
  <script>
  var now = new Date();
  function createtime(){
      var grt= new Date("02/14/2020 00:00:00");//此处修改你的建站时间或者网站上线时间
      now.setTime(now.getTime()+250);
      days = (now - grt ) / 1000 / 60 / 60 / 24;
      dnum = Math.floor(days);
      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
      hnum = Math.floor(hours);
      if(String(hnum).length ==1 ){
          hnum = "0" + hnum;
      }
      minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
      mnum = Math.floor(minutes);
      if(String(mnum).length ==1 ){
                mnum = "0" + mnum;
      }
      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
      snum = Math.round(seconds);
      if(String(snum).length ==1 ){
                snum = "0" + snum;
      }
      document.getElementById("timeDate").innerHTML = "已仰望星空：&nbsp"+dnum+"&nbsp天";
      document.getElementById("times").innerHTML = hnum + "&nbsp小时&nbsp" + mnum + "&nbsp分&nbsp" + snum + "&nbsp秒";
  }
  setInterval("createtime()",250);
  </script>
</div>
<p id="hitokoto">:D 获取中...</p>
<script>
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      const hitokoto = document.getElementById('hitokoto')
      hitokoto.innerText = data.hitokoto
      })
      .catch(console.error)
</script>

  </div>


</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>





  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').each(function () {
        const pre = $(this);
        if (pre.find('code.mermaid').length > 0) {
          return;
        }
        pre.addClass('prettyprint  linenums');
      });
      prettyPrint();
    })
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "机器学习程序练习1:线性回归&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 90,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
              processEscapes: true,
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          }
      });
      MathJax.Hub.Register.StartupHook("End Jax",function () {
        var BROWSER = MathJax.Hub.Browser;
        var jax = "HTML-CSS";
        if (BROWSER.isMSIE && BROWSER.hasMathPlayer) jax = "NativeMML";
        return MathJax.Hub.setRenderer(jax);
      });
      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });

    </script>

    <script  src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" ></script>

  














</body>
</html>
